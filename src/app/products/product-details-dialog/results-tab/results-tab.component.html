<ul class="results-list">
  <li *ngFor="let result of results" class="result-item">
    <div *ngFor="let suite of result.testSuites" class="suite-item" (click)="toggleSuiteExpansion(suite.id)">
      <div class="suite-header">
        <span class="suite-name"> {{ suite.name }} ({{ suite.time }}s) </span>
        <span class="date-reported">{{ result.dateReported | date: 'short' }}</span>
      </div>
      <div *ngIf="expandedSuites[suite.id]">
        <table mat-table [dataSource]="suite.testCases" class="mat-elevation-z8">
          <!-- Test Case Name Column -->
          <ng-container matColumnDef="caseName">
            <th mat-header-cell *matHeaderCellDef>Test Case</th>
            <td mat-cell *matCellDef="let testCase">{{ testCase.name }}</td>
          </ng-container>
          <!-- Test Case Time Column -->
          <ng-container matColumnDef="caseTime">
            <th mat-header-cell *matHeaderCellDef>Time</th>
            <td mat-cell *matCellDef="let testCase">{{ testCase.time }}s</td>
          </ng-container>
          <!-- Test Case Status Column -->
          <ng-container matColumnDef="caseStatus">
            <th mat-header-cell *matHeaderCellDef>Status</th>
            <td mat-cell *matCellDef="let testCase">
              <span
                [ngClass]="{
                  passed: testCase.status === 'pass',
                  failed: testCase.status === 'fail',
                  error: testCase.status === 'error',
                  skipped: testCase.status === 'skipped',
                }"
              >
                {{ testCase.status.charAt(0).toUpperCase() + testCase.status.slice(1) }}
              </span>
            </td>
          </ng-container>
          <!-- Test Case Message Column -->
          <ng-container matColumnDef="caseMessage">
            <th mat-header-cell *matHeaderCellDef>Message</th>
            <td mat-cell *matCellDef="let testCase">
              <div class="message-container" *ngIf="testCase.message">
                <pre>{{ testCase.message }}</pre>
                <button mat-icon-button (click)="copyMessage(testCase.message)">
                  <mat-icon>content_copy</mat-icon>
                </button>
                <button mat-icon-button (click)="openMessageDialog(testCase.message, $event)">
                  <mat-icon>visibility</mat-icon>
                </button>
              </div>
            </td>
          </ng-container>
          <tr mat-header-row *matHeaderRowDef="['caseName', 'caseTime', 'caseStatus', 'caseMessage']"></tr>
          <tr mat-row *matRowDef="let row; columns: ['caseName', 'caseTime', 'caseStatus', 'caseMessage']"></tr>
        </table>
      </div>
    </div>
  </li>
</ul>
